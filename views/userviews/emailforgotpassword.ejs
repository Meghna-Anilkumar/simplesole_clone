<%-include('./header')%>
<style>
.container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.forgot-password-box {
  background-color: #f0f0f0;
  padding: 40px;
  border-radius: 15px;
  box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
  border: 2px solid #ccc;
  width: 90%;
  max-width: 400px;
}

.forgot-password-title {
  background-color: black;
  color: white;
  text-align: center;
  padding: 10px 0;
  margin: 0 0 20px;
  border-radius: 5px;
}

.inputBox {
  margin-bottom: 20px;
}

.inputBox input[type="email"] {
  width: 100%;
  border: none;
  border-bottom: 2px solid #262626;
  outline: none;
  height: 40px;
  color: #000;
  background: transparent;
  font-size: 16px;
  padding-left: 20px;
  box-sizing: border-box;
}

.inputBox input[type="email"]:hover {
  color: #42F3FA;
  border: 1px solid #42F3FA;
  box-shadow: 0 0 5px rgba(0, 255, 0, .3), 0 0 10px rgba(0, 255, 0, .2), 0 0 15px rgba(0, 255, 0, .1), 0 2px 0 black;
}

.inputBox input[type="email"]:focus {
  border-bottom: 2px solid #42F3FA;
}

.send-otp-btn {
  border: none;
  outline: none;
  height: 40px;
  width: 50%;
  font-size: 16px;
  background: black;
  color: #fff;
  border-radius: 5px;
  cursor: pointer;
  display: block;
  margin: 0 auto;
}

.send-otp-btn:disabled {
  background: #666;
  cursor: not-allowed;
}

.error-message {
  color: #dc3545;
  font-size: 0.875rem;
  margin-top: 5px;
  margin-bottom: 10px;
  display: none;
}

.is-invalid {
  border-bottom: 2px solid #dc3545 !important;
}
</style>

<div class="container">
  <div class="forgot-password-box">
    <h2 class="forgot-password-title">Forgot Password</h2>
    <% if (typeof error !== 'undefined') { %>
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        <%= error %>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    <% } %>
    <form action="/forgot-password" method="post" id="forgotPasswordForm" novalidate>
      <div class="inputBox"> 
        <input id="email" type="email" name="email" placeholder="Enter email id" required> 
        <div id="emailError" class="error-message">Please enter a valid email address.</div>
      </div> 
      <input type="submit" value="Send OTP" class="send-otp-btn" id="submitBtn" disabled>
    </form>
  </div>
</div>

<script>
  const form = document.getElementById('forgotPasswordForm');
  const submitBtn = document.getElementById('submitBtn');
  const emailInput = document.getElementById('email');
  let isEmailTouched = false;

  // Validation rule for email
  function validateEmail() {
    const value = emailInput.value.trim();
    const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value);
    const errorElement = document.getElementById('emailError');

    if (isEmailTouched) {
      if (!isValid) {
        emailInput.classList.add('is-invalid');
        errorElement.style.display = 'block';
      } else {
        emailInput.classList.remove('is-invalid');
        errorElement.style.display = 'none';
      }
    } else {
      emailInput.classList.remove('is-invalid');
      errorElement.style.display = 'none';
    }

    submitBtn.disabled = !isValid;
    return isValid;
  }

  // Live validation on input
  emailInput.addEventListener('input', () => {
    isEmailTouched = true;
    validateEmail();
  });

  // Mark as touched on blur
  emailInput.addEventListener('blur', () => {
    isEmailTouched = true;
    validateEmail();
  });

  // Prevent invalid form submission
  form.addEventListener('submit', (event) => {
    isEmailTouched = true;
    if (!validateEmail()) {
      event.preventDefault();
    }
  });
</script>

<%-include('./footer')%>